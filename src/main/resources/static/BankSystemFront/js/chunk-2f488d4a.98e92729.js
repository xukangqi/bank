(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f488d4a"],{"2fdb":function(t,e,a){"use strict";var n=a("5ca1"),o=a("d2c8"),s="includes";n(n.P+n.F*a("5147")(s),"String",{includes:function(t){return!!~o(this,t,s).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},5039:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",[n("a-table",{attrs:{dataSource:e.data,columns:e.columns,scroll:{x:1500}},scopedSlots:e._u([{key:"filterDropdown",fn:function(t){var a=t.setSelectedKeys,o=t.selectedKeys,s=t.confirm,i=t.clearFilters;return n("div",{staticClass:"custom-filter-dropdown"},[n("a-input",{ref:"searchInput",attrs:{placeholder:"查找用户",value:o[0]},on:{change:function(t){return a(t.target.value?[t.target.value]:[])},pressEnter:function(){return e.handleSearch(o,s)}}}),n("a-button",{attrs:{type:"primary"},on:{click:function(){return e.handleSearch(o,s)}}},[e._v("Search")]),n("a-button",{on:{click:function(){return e.handleReset(i)}}},[e._v("Reset")])],1)}},{key:"filterIcon",fn:function(t){return n("a-icon",{style:{color:t?"#108ee9":"#aaa"},attrs:{type:"search"}})}},{key:"customRender",fn:function(t){return[e.searchText?n("span",[e._l(t.split(new RegExp("(?<="+e.searchText+")|(?="+e.searchText+")","i")),function(t,a){return[t.toLowerCase()===e.searchText.toLowerCase()?n("span",{key:a,staticClass:"highlight"},[e._v(e._s(t))]):[e._v(e._s(t))]]})],2):[e._v(e._s(t))]]}},{key:"filterDropdown1",fn:function(t){var a=t.setSelectedKeys,o=t.selectedKeys,s=t.confirm,i=t.clearFilters;return n("div",{staticClass:"custom-filter-dropdown"},[n("a-input",{ref:"searchInput",attrs:{placeholder:"查找手机号",value:o[0]},on:{change:function(t){return a(t.target.value?[t.target.value]:[])},pressEnter:function(){return e.handleSearch(o,s)}}}),n("a-button",{attrs:{type:"primary"},on:{click:function(){return e.handleSearch(o,s)}}},[e._v("Search")]),n("a-button",{on:{click:function(){return e.handleReset(i)}}},[e._v("Reset")])],1)}},{key:"filterIcon1",fn:function(t){return n("a-icon",{style:{color:t?"#108ee9":"#aaa"},attrs:{type:"search"}})}},{key:"customRender1",fn:function(t){return[e.searchText?n("span",[e._l(t.split(new RegExp("(?<="+e.searchText+")|(?="+e.searchText+")","i")),function(t,a){return[t.toLowerCase()===e.searchText.toLowerCase()?n("span",{key:a,staticClass:"highlight"},[e._v(e._s(t))]):[e._v(e._s(t))]]})],2):[e._v(e._s(t))]]}},{key:"operation",fn:function(t,a){return[n("a-button",{attrs:{type:"primary"},on:{click:function(){return e.showDrawer(a.custId)}}},[e._v("显示详情")])]}}])}),n("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"'auto'",paddingBottom:"53px"},attrs:{title:"详情",width:"720",placement:"right",closable:!1,visible:e.visible},on:{close:e.onClose}},[n("div",[n("a-collapse",{attrs:{accordion:""}},[n("a-collapse-panel",{key:"1",attrs:{header:"用户详细信息"}},[n("p",[e._v("用户ID:"+e._s(this.detailValue.custId))]),n("p",[e._v("用户姓名:"+e._s(this.detailValue.custName))]),n("p",[e._v("用户身份证:"+e._s(this.detailValue.identityCard))]),n("p",[e._v("用户联系地址:"+e._s(this.detailValue.address))]),n("p",[e._v("用户手机号:"+e._s(this.detailValue.phone))]),n("p",[e._v("用户邮箱:"+e._s(this.detailValue.email))]),n("p",[e._v("用户性别:"+e._s(e.formatSex(this.detailValue.sex)))]),n("p",[e._v("用户类型:"+e._s(e.formatCustType(this.detailValue.custType)))]),n("p",[e._v("用户信用:"+e._s(e.formatCredit(this.detailValue.credit)))])]),n("a-collapse-panel",{key:"2",attrs:{header:"用户拥有账户",disabled:!1}},[n("a-table",{attrs:{columns:e.accountColumns,dataSource:e.accountData,scroll:{x:900}},scopedSlots:e._u([{key:"operation",fn:function(t,a){return[n("a-button",{attrs:{type:"primary"},on:{click:function(){return e.del(a.account)}}},[e._v("销户")])]}}])}),n("a-modal",{attrs:{title:"警告",visible:e.Modelvisible,confirmLoading:e.confirmLoading},on:{ok:e.handleOk,cancel:e.handleCancel}},[n("p",[e._v("确认要对账号:"+e._s(this.delAccount)+"销户吗？")])])],1),n("a-collapse-panel",{key:"3",attrs:{header:"修改用户信息",disabled:!1}},[n("a-form",{staticStyle:{"margin-top":"10px"},attrs:{autoFormCreate:function(e){t.form=e}},on:{submit:e.handleSubmit}},[n("a-form-item",{attrs:{label:"手机号",labelCol:{span:5},wrapperCol:{span:12},fieldDecoratorId:"phone",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入申请人手机号"},{validator:this.checkTelephone}]}}},[n("a-input")],1),n("a-form-item",{attrs:{label:"邮箱",labelCol:{span:5},wrapperCol:{span:12},fieldDecoratorId:"email",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入邮箱"},{validator:this.checkEmail}]}}},[n("a-input")],1),n("a-form-item",{attrs:{label:"所在地区",labelCol:{span:5},wrapperCol:{span:12},fieldDecoratorId:"address",fieldDecoratorOptions:{rules:[{required:!0,message:"请选择所在地区"}]}}},[n("a-cascader",{attrs:{options:e.address,placeholder:"请选择你所在的地址"}})],1),n("a-form-item",{attrs:{label:"详细地址",labelCol:{span:5},wrapperCol:{span:12},fieldDecoratorId:"detailAddress",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入详细地址"}]}}},[n("a-input")],1),n("a-form-item",{attrs:{label:"账户密码",labelCol:{span:5},wrapperCol:{span:12},fieldDecoratorId:"password",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入账户密码"}]}}},[n("a-input",{attrs:{type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),n("a-form-item",{attrs:{label:"重复账户密码",labelCol:{span:5},wrapperCol:{span:12},fieldDecoratorId:"password2",fieldDecoratorOptions:{rules:[{required:!0,message:"请再次输入账户密码"},{validator:this.checkPassword}]}}},[n("a-input",{attrs:{type:"password"}})],1),n("a-form-item",{attrs:{wrapperCol:{span:12,offset:5}}},[n("a-button",{attrs:{type:"primary",htmlType:"submit"}},[e._v("\n                                提交申请\n                            ")])],1)],1)],1)],1)],1),n("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[n("a-button",{style:{marginRight:8},on:{click:e.onClose}},[e._v("\n                关闭\n            ")])],1)])],1)},o=[],s=a("6bde"),i=(a("6762"),a("2fdb"),a("6d18")),r=i["a"].address,c={name:"CustomerInfo",data:function(){var t=this;return{formLayout:"horizontal",data:[],clickrow:0,searchText:"",custId:0,visible:!1,Modelvisible:!1,delAccount:0,confirmLoading:!1,detailValue:{},address:r,password:void 0,columns:[{title:"客户ID",dataIndex:"custId",key:"custId",width:190,fixed:"left"},{title:"用户姓名",dataIndex:"custName",key:"custName",width:90,scopedSlots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon",customRender:"customRender"},onFilter:function(t,e){return e.custName.includes(t)},onFilterDropdownVisibleChange:function(e){e&&setTimeout(function(){t.$refs.searchInput.focus()})}},{title:"身份证",dataIndex:"identityCard",key:"identityCard",width:120},{title:"手机号",dataIndex:"phone",key:"phone",width:110,scopedSlots:{filterDropdown:"filterDropdown1",filterIcon:"filterIcon1",customRender:"customRender1"},onFilter:function(t,e){return e.phone.includes(t)},onFilterDropdownVisibleChange:function(e){e&&setTimeout(function(){t.$refs.searchInput.focus()})}},{title:"客户信用",dataIndex:"credit",key:"credit",width:80},{title:"客户类型",dataIndex:"custType",key:"custType",width:100,filters:[{text:"个人用户",value:"个人用户"},{text:"企业用户",value:"企业用户"}],onFilter:function(t,e){return e.custType==t}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},width:50}],accountData:[],accountColumns:[{title:"账户号",dataIndex:"account",key:"account",fixed:"left",width:180},{title:"余额",dataIndex:"balances",key:"balances"},{title:"不可用余额",dataIndex:"blockedBalances",key:"blockedBalances"},{title:"账户类型",dataIndex:"accountType",key:"accountType"},{title:"账户种类",dataIndex:"accountKind",key:"accountKind"},{title:"账户状态",dataIndex:"accountStatus",key:"accountStatus"},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}]}},methods:{handleSearch:function(t,e){e(),this.searchText=t[0]},handleReset:function(t){t(),this.searchText=""},showDrawer:function(t){var e=this;this.custId=t,console.log("custId  "+this.custId),this.$axios({method:"get",url:"/customer/"+this.custId}).then(function(t){var a=t.data,n=a.status;200==n?e.detailValue=a.data:e.$notification.open({message:"错误",description:a.msg})}).catch(function(t){console.log(t),e.$notification.open({message:"错误",description:"服务器开小差了,请稍后再试"})}),this.$axios({method:"get",url:"/customer/account/"+this.custId}).then(function(t){var a=t.data,n=a.status;if(200==n){for(var o=a.data,s=0;s<o.length;s++)o[s].accountType=e.formatAccountType(o[s].accountType),o[s].accountKind=e.formatAccountKind(o[s].accountKind),o[s].accountStatus=e.formatAccountStatus(o[s].accountStatus);e.accountData=o}else e.$notification.open({message:"错误",description:a.msg})}).catch(function(t){console.log(t),e.$notification.open({message:"错误",description:"服务器开小差了,请稍后再试"})}),this.visible=!0},del:function(t){this.delAccount=t,this.Modelvisible=!0},handleOk:function(){for(var t=this,e=!1,a=0;a<this.accountData.length;a++)if(this.accountData[a].account==this.delAccount&&"销户"==this.accountData[a].accountStatus){this.$notification.open({message:"错误",description:"账户已消除"}),e=!0;break}e?setTimeout(function(){t.Modelvisible=!1,t.confirmLoading=!1},1e3):this.$axios({method:"post",url:"/customer/account/delete",params:{account:this.delAccount}}).then(function(e){var a=e.data;if(200==a.status){for(var n=0;n<t.accountData.length;n++)if(t.accountData[n].account==t.delAccount){t.accountData[n].accountStatus="销户";break}t.confirmLoading=!0,setTimeout(function(){t.Modelvisible=!1,t.confirmLoading=!1},2e3)}else t.$notification.open({message:"错误",description:a.msg}),t.Modelvisible=!1}).catch(function(e){t.$notification.open({message:"错误",description:"服务器开小差了,请稍后再试"}),t.Modelvisible=!1})},handleCancel:function(){this.Modelvisible=!1},onClose:function(){this.visible=!1},formatCredit:function(t){var e="";switch(parseInt(t)){case 1:e="优秀";break;case 2:e="良好";break;case 3:e="较差";break}return e},formatCustType:function(t){var e="";switch(parseInt(t)){case 1:e="个人用户";break;case 2:e="企业用户";break}return e},formatSex:function(t){return 1==t?"男":"女"},formatAccountType:function(t){var e="";switch(parseInt(t)){case 1:e="个人";break;case 2:e="企业";break}return e},formatAccountKind:function(t){var e="";switch(parseInt(t)){case 1:e="一类";break;case 2:e="二类";break;case 3:e="三类";break}return e},formatAccountStatus:function(t){var e="";switch(parseInt(t)){case 1:e="正常";break;case 2:e="冻结";break;case 3:e="销户";break}return e},checkTelephone:function(t,e,a){void 0==Object(s["a"])(e)&&a(),/^1[34578]\d{9}$/.test(e)?a():a("手机号码错误")},checkPassword:function(t,e,a){void 0==Object(s["a"])(e)?a("请再次输入密码"):e===this.password?a():a("密码不一致")},checkEmail:function(t,e,a){var n=/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/;void 0==Object(s["a"])(e)&&a("请输入邮箱"),n.test(e)?a():a("邮箱格式错误")},handleSubmit:function(t){var e=this;t.preventDefault(),this.form.validateFields(function(t,a){if(!t){for(var n="",o=0;o<a.address.length;o++)n+=a.address[o];n+=a.detailAddress,e.$axios({method:"post",url:"/customer/edit",params:{custId:e.custId,phone:a.phone,address:n,password:a.password,email:a.email}}).then(function(t){var a=t.data;200==a.status?(e.$notification.open({message:"修改成功",description:"修改用户信息成功"}),setTimeout(function(){e.form.resetFields(),e.visible=!1},400)):e.$notification.open({message:"提交请求失败",description:a.msg})}).catch(function(t){e.$notification.open({message:"错误",description:"服务器开小差了,请稍后再试"})})}})}},mounted:function(){var t=this;this.$axios({method:"get",url:"/customer/all"}).then(function(e){var a=e.data,n=a.status;if(console.log(a),200==n){for(var o=0;o<a.data.length;o++)a.data[o].custType=t.formatCustType(a.data[o].custType),a.data[o].credit=t.formatCredit(a.data[o].credit);t.data=a.data}else t.$notification.open({message:"错误",description:a.msg})}).catch(function(e){console.log(e),t.$notification.open({message:"错误",description:"服务器开小差了,请稍后再试"})})}},l=c,d=(a("d5fe"),a("2877")),u=Object(d["a"])(l,n,o,!1,null,"b09964b4",null);u.options.__file="CustomerInfo.vue";e["default"]=u.exports},5147:function(t,e,a){var n=a("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[n]=!1,!"/./"[t](e)}catch(t){}}return!0}},6762:function(t,e,a){"use strict";var n=a("5ca1"),o=a("c366")(!0);n(n.P,"Array",{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")("includes")},"8bb9":function(t,e,a){},d2c8:function(t,e,a){var n=a("aae3"),o=a("be13");t.exports=function(t,e,a){if(n(e))throw TypeError("String#"+a+" doesn't accept regex!");return String(o(t))}},d5fe:function(t,e,a){"use strict";var n=a("8bb9"),o=a.n(n);o.a}}]);
//# sourceMappingURL=chunk-2f488d4a.98e92729.js.map